{"version":3,"sources":["webpack:///E:/晨儿/2.28/new-lama/App.vue?3673","webpack:///E:/晨儿/2.28/new-lama/App.vue?e881","webpack:///E:/晨儿/2.28/new-lama/App.vue?584e","webpack:///E:/晨儿/2.28/new-lama/common/checkUpdater.js","webpack:///E:/晨儿/2.28/new-lama/main.js","webpack:///E:/晨儿/2.28/new-lama/App.vue","webpack:///E:/晨儿/2.28/new-lama/App.vue?0772"],"names":["checkUpdater","currentId","updaterPage","uni","request","url","method","data","success","res","statusCode","response","latestId","number","console","log","iosLink","ios","androidLink","android","downloadLink","ready","plus","os","name","toLowerCase","match","RegExp","downloadTask","downloadFile","saveFile","tempFilePath","packgePath","savedFilePath","setStorage","key","completed","abort","showModal","title","content","showCancel","complete","runtime","restart","confirm","navigateTo","cancel","currentVersion","id","Vue","config","productionTip","prototype","$current","App","mpType","apiUrl","userLoginInfo","backpage","backtype","getStorageSync","encodeURIComponent","redirectTo","app","$mount","onLaunch","updated","removeSavedFile","filePath","removeStorageSync","install","force","onShow","onHide"],"mappings":"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","file":"common/main.js","sourcesContent":["var render, staticRenderFns\nimport script from \"./App.vue?vue&type=script&lang=js&\"\nexport * from \"./App.vue?vue&type=script&lang=js&\"\nimport style0 from \"./App.vue?vue&type=style&index=0&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"E:\\\\晨儿\\\\2.28\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-hot-reload-api\\\\dist\\\\index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!module.hot.data) {\n      api.createRecord('4a787e54', component.options)\n    } else {\n      api.reload('4a787e54', component.options)\n    }\n    \n  }\n}\ncomponent.options.__file = \"new-lama/App.vue\"\nexport default component.exports","import mod from \"-!../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--18-0!../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--18-0!../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"","import mod from \"-!../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--10-oneOf-1-1!../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/index.js??ref--10-oneOf-1-2!../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/loaders/stylePostLoader.js!../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-3!../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-4!../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=less&\"; export default mod; export * from \"-!../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--10-oneOf-1-1!../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/index.js??ref--10-oneOf-1-2!../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/loaders/stylePostLoader.js!../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-3!../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-4!../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=less&\"","export function checkUpdater(currentId, updaterPage) {\r\n\tuni.request({\r\n\t\turl: 'https://api.lamamuying.com/system/getVersion',\r\n\t\tmethod: 'GET',\r\n\t\tdata: {\r\n\r\n\t\t},\r\n\t\tsuccess: res => {\r\n\t\t\t//console.log(res);\r\n\t\t\tif (res.statusCode === 200) {\r\n\t\t\t\tconst response = res.data.data\r\n\t\t\t\tconst latestId = response.number\r\n\t\t\t\tconst method = response.method\r\n\t\t\t\tif (!latestId) {\r\n\t\t\t\t\tconsole.log('当前没有发行版本')\r\n\t\t\t\t} else if (currentId != latestId && method === 'force') {\r\n\t\t\t\t\tconsole.log('确认强制更新，正在取得地址')\r\n\t\t\t\t\tconsole.log('地址请求成功')\r\n\t\t\t\t\tconst iosLink = response.ios\r\n\t\t\t\t\tconst androidLink = response.android\r\n\t\t\t\t\tlet downloadLink = ''\r\n\t\t\t\t\tlet ready = false\r\n\t\t\t\t\t// 判断系统类型\r\n\t\t\t\t\tif (plus.os.name.toLowerCase() === 'android') {\r\n\t\t\t\t\t\tconsole.log('安卓系统')\r\n\t\t\t\t\t\tif (androidLink && androidLink !== '#') { // 我这里默认#也是没有地址，请根据业务自行修改\r\n\t\t\t\t\t\t\tconsole.log('发现下载地址')\r\n\t\t\t\t\t\t\t// 安卓：创建下载任务\r\n\t\t\t\t\t\t\tif (androidLink.match(RegExp(/.wgt/))) {\r\n\t\t\t\t\t\t\t\tconsole.log('确认wgt热更新包')\r\n\t\t\t\t\t\t\t\tdownloadLink = androidLink\r\n\t\t\t\t\t\t\t\tready = true\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tconsole.log('安卓推荐.wgt强制更新，.apk的强制更新请您自行修改程序')\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tconsole.log('下载地址是空的，无法继续')\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tconsole.log('苹果系统')\r\n\t\t\t\t\t\tif (iosLink && iosLink !== '#') { // 我这里默认#也是没有地址，请根据业务自行修改\r\n\t\t\t\t\t\t\tconsole.log('发现下载地址')\r\n\t\t\t\t\t\t\t// 苹果(A)：进行热更新（如果iosLink是wgt更新包的下载地址）判断文件名中是否含有.wgt\r\n\t\t\t\t\t\t\tif (iosLink.match(RegExp(/.wgt/))) {\r\n\t\t\t\t\t\t\t\tconsole.log('确认wgt热更新包')\r\n\t\t\t\t\t\t\t\tdownloadLink = iosLink\r\n\t\t\t\t\t\t\t\tready = true\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tconsole.log('苹果只支持.wgt强制更新')\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tconsole.log('下载地址是空的，无法继续')\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (ready) {\r\n\t\t\t\t\t\tconsole.log('任务开始')\r\n\t\t\t\t\t\tlet downloadTask = uni.downloadFile({\r\n\t\t\t\t\t\t\turl: downloadLink,\r\n\t\t\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\t\t\tif (res.statusCode === 200) {\r\n\t\t\t\t\t\t\t\t\t// 保存下载的安装包\r\n\t\t\t\t\t\t\t\t\tconsole.log('保存安装包')\r\n\t\t\t\t\t\t\t\t\tuni.saveFile({\r\n\t\t\t\t\t\t\t\t\t\ttempFilePath: res.tempFilePath,\r\n\t\t\t\t\t\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\t\t\t\t\t\tconst packgePath = res.savedFilePath\r\n\t\t\t\t\t\t\t\t\t\t\t// 保存更新记录到stroage，下次启动app时安装更新\r\n\t\t\t\t\t\t\t\t\t\t\tuni.setStorage({\r\n\t\t\t\t\t\t\t\t\t\t\t\tkey: 'updated',\r\n\t\t\t\t\t\t\t\t\t\t\t\tdata: {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcompleted: false,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tpackgePath: packgePath\r\n\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\tsuccess: () => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log('成功保存记录')\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t// 任务完成，关闭下载任务\r\n\t\t\t\t\t\t\t\t\t\t\t//console.log('任务完成，关闭下载任务，下一次启动应用时将安装更新')\r\n\t\t\t\t\t\t\t\t\t\t\tdownloadTask.abort()\r\n\t\t\t\t\t\t\t\t\t\t\tdownloadTask = null\r\n\t\t\t\t\t\t\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\t\t\t\t\t\t\ttitle: '提示',\r\n\t\t\t\t\t\t\t\t\t\t\t\tcontent: '应用将重启以完成更新',\r\n\t\t\t\t\t\t\t\t\t\t\t\tshowCancel: false,\r\n\t\t\t\t\t\t\t\t\t\t\t\tcomplete: () => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tplus.runtime.restart()\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tconsole.log('下载地址未准备，无法开启下载任务')\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (currentId != latestId) {\r\n\t\t\t\t\tconsole.log('检测到更新')\r\n\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\ttitle: '发现新版本',\r\n\t\t\t\t\t\tcontent: '有新版本可用 (版本id:' + latestId + ')，请问您是否更新？',\r\n\t\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\t\tif (res.confirm) {\r\n\t\t\t\t\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\t\t\t\t\turl: updaterPage\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t} else if (res.cancel) {\r\n\t\t\t\t\t\t\t\tconsole.log('取消')\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconsole.log('现在是最新版本')\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t})\r\n}\r\n","import 'uni-pages';\r\nimport Vue from 'vue'\r\nimport App from './App'\r\n\r\nconst currentVersion = {\r\n    id: 1006\r\n}\r\n\r\n// 未找到\r\n// import store from './store/store.js'\r\n// import '@/static/css/reset.scss'\r\n// import '@/static/iconfont/iconfont.css' //使用字体图标\r\n// import '@/static/js/constant.js'\r\n\r\nVue.config.productionTip = false\r\nVue.prototype.$current = currentVersion\r\nApp.mpType = 'app'\r\n//全局封装APIhttps://api.lamamuying.com/\r\nVue.prototype.apiUrl = 'https://api.lamamuying.com/'\r\n//用户登录信息\r\nVue.prototype.userLoginInfo = function(backpage, backtype){\r\n// \tconsole.log(backtype);\r\n// \tconsole.log(userLoginInfo);\r\n\tvar userLoginInfo  = uni.getStorageSync('userLoginInfo');\r\n\tif(!userLoginInfo){\r\n\t\t// console.log(backpage);\r\n\t\tbackpage = encodeURIComponent(backpage);\r\n\t\t// console.log(backpage);\r\n\t\tuni.redirectTo({\r\n\t\t\turl:\"../login/login?backtype=\"+backtype+\"&backpage=\"+backpage\r\n\t\t});\r\n\t\treturn false;\r\n\t}\r\n\treturn userLoginInfo;\r\n}\r\n\r\nconst app = new Vue({\r\n    ...App\r\n})\r\napp.$mount()","\n\timport { checkUpdater } from '@/common/checkUpdater'\n\texport default {\n\t\tonLaunch: function () {\n\t\t\tconsole.log('App Launch')\n\t\t\tconst updated = uni.getStorageSync('updated') // 尝试读取storage\n\t\t\t\n\t\t\tif (updated.completed === true) { // 如果上次刚更新过\n\t\t\t\t// 删除安装包及安装记录\n\t\t\t\tconsole.log('安装记录被删除，更新成功')\n\t\t\t\tuni.removeSavedFile({ \n\t\t\t\t\tfilePath: updated.packgePath,\n\t\t\t\t\tsuccess: (res) => {\n\t\t\t\t\t\tuni.removeStorageSync('updated')\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t} else if (updated.completed === false) {\n\t\t\t\tuni.removeStorageSync('updated')\n\t\t\t\tplus.runtime.install(updated.packgePath, { force: true })\n\t\t\t\tuni.setStorage({\n\t\t\t\t\tkey: 'updated',\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tcompleted: true,\n\t\t\t\t\t\tpackgePath: updated.packgePath\n\t\t\t\t\t},\n\t\t\t\t\tsuccess: (res) => {\n\t\t\t\t\t\tconsole.log('成功安装上次的更新，应用需要重启才能继续完成')\n\t\t\t\t\t}\n\t\t\t\t})     \t\t\t\t\n\t\t\t} else {\n\t\t\t\t// 检查更新，参数：{ 当前版本号，跳转到更新页面的url }\n\t\t\t\tcheckUpdater(this.$current.id, '../update/index') \n\t\t\t}\n\t\t},\n\t\tonShow: function () {\n\t\t\t// 关闭启动页\n// \t\t\tsetTimeout(()=>{\n// \t\t\t\tplus.navigator.closeSplashscreen();\n// \t\t\t},0);\n\t\t\tconsole.log('App Show')\n\t\t},\n\t\tonHide: function () {\n\t\t\tconsole.log('App Hide')\n\t\t}\n\t}\n","// extracted by mini-css-extract-plugin"],"sourceRoot":""}