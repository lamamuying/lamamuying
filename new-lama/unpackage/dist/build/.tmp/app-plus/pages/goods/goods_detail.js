(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/goods/goods_detail"],{"0b97":function(t,s,i){"use strict";i.r(s);var e=i("d542"),a=i("8c97");for(var o in a)"default"!==o&&function(t){i.d(s,t,function(){return a[t]})}(o);i("bf90");var n=i("2877"),c=Object(n["a"])(a["default"],e["a"],e["b"],!1,null,null,null);s["default"]=c.exports},"54cb":function(t,s,i){"use strict";i.r(s);var e=i("e35f"),a=i.n(e);for(var o in e)"default"!==o&&function(t){i.d(s,t,function(){return e[t]})}(o);s["default"]=a.a},"7e1b":function(t,s,i){},"856f":function(t,s,i){"use strict";i.r(s);var e=i("edc6"),a=i("54cb");for(var o in a)"default"!==o&&function(t){i.d(s,t,function(){return a[t]})}(o);i("f99a");var n=i("2877"),c=Object(n["a"])(a["default"],e["a"],e["b"],!1,null,null,null);s["default"]=c.exports},"8c97":function(t,s,i){"use strict";i.r(s);var e=i("9fd4"),a=i.n(e);for(var o in e)"default"!==o&&function(t){i.d(s,t,function(){return e[t]})}(o);s["default"]=a.a},"9fd4":function(t,s,i){"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;var e={name:"uni-number-box",props:{value:{type:Number,default:0},min:{type:Number,default:-1/0},max:{type:Number,default:1/0},step:{type:Number,default:1},disabled:{type:Boolean,default:!1}},data:function(){return{inputValue:this.value}},computed:{disableSubtract:function(){return this.value<=this.min},disableAdd:function(){return this.value>=this.max}},watch:{value:function(t){this.inputValue=t},inputValue:function(t){this.$emit("change",t)}},methods:{_calcValue:function(t){var s=this._getDecimalScale(),i=this.inputValue*s,e=this.step*s;"subtract"===t?i-=e:"add"===t&&(i+=e),i<this.min||i>this.max||(this.inputValue=i/s)},_getDecimalScale:function(){var t=1;return~~this.step!==this.step&&(t=Math.pow(10,(this.step+"").split(".")[1].length)),t},_onBlur:function(t){var s=t.detail.value;s?(s=+s,s>this.max?s=this.max:s<this.min&&(s=this.min),this.inputValue=s):this.inputValue=0}}};s.default=e},b030:function(t,s,i){"use strict";i("1db4");var e=o(i("b0ce")),a=o(i("856f"));function o(t){return t&&t.__esModule?t:{default:t}}Page((0,e.default)(a.default))},bf90:function(t,s,i){"use strict";var e=i("7e1b"),a=i.n(e);a.a},d542:function(t,s,i){"use strict";var e=function(){var t=this,s=t.$createElement,i=t._self._c||s;return i("view",{staticClass:"uni-numbox"},[i("view",{staticClass:"uni-numbox-minus",class:{"uni-numbox-disabled":t.disableSubtract},attrs:{eventid:"e3719524-0"},on:{click:function(s){t._calcValue("subtract")}}},[t._v("-")]),i("input",{staticClass:"uni-numbox-value",attrs:{type:"number",disabled:t.disabled,value:t.inputValue,eventid:"e3719524-1"},on:{blur:t._onBlur}}),i("view",{staticClass:"uni-numbox-plus",class:{"uni-numbox-disabled":t.disableAdd},attrs:{eventid:"e3719524-2"},on:{click:function(s){t._calcValue("add")}}},[t._v("+")])])},a=[];i.d(s,"a",function(){return e}),i.d(s,"b",function(){return a})},e35f:function(t,s,i){"use strict";(function(t){Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;var e,a,o,n,c,r=l(i("e636")),u=l(i("0b97"));function l(t){return t&&t.__esModule?t:{default:t}}var d={components:{myDrawer:r.default,uniNumberBox:u.default},data:function(){return{icon1:0,goods:{attrs:[],attrs_list:[]},goodsImages:[],productList:[],goodsComment:[],openAttr:!1,collectBackImage:"http://static.lamamuying.com/static/images/icon_collect.png",cartGoodsCount:0,numberValue:1,selectArr:[],shopItemInfo:{},subIndex:[],goodsAttrId:"",selectGoodsAttr:{},cart:[],identity:1}},onLoad:function(s){c=s,o=t.getStorageSync("userLoginInfo"),o.identity&&(this.identity=o.identity),this.getCartCount(),this.getGoods()},methods:{heart:function(){this.icon1=0===this.icon1?1:0,1===this.icon1?t.showToast({title:"收藏成功",icon:"none"}):t.showToast({title:"取消收藏",icon:"none"})},getGoods:function(){var s=this;t.request({url:this.apiUrl+"goods/getGoodsView",method:"GET",data:{goods_id:c.goods_id,identity:this.identity},success:function(t){if(0==t.data.code){var i=t.data.data,e=t.data.data.content;t.data.data.content=e.replace(/\<img/gi,'<img style="width:100%;height:auto" '),s.goods=t.data.data,s.goodsImages=i.goods_images,s.goodsComment=i.comment,s.goods.attrs=i.attr.attrs,s.goods.attrs_list=i.attr.attrs_list,s.intiAttrs(),n=s.goodsImages}},fail:function(){},complete:function(){}})},previewImage:function(t){var s=[],i=t.currentTarget.dataset.src;n.forEach(function(t){s.push(t.image)}),wx.previewImage({loop:!0,current:i,urls:s})},getCart:function(){for(var t=0;t<a.length;t++)a[t].uid==e.id&&(this.cart=a[t].goods)},getCartCount:function(){var s=t.getStorageSync("userLoginInfo"),i=t.getStorageSync("cartGoods");if(s&&i)for(var e=0;e<i.length;e++)i[e].uid==s.id&&(this.cartGoodsCount=i[e].goods.length);else this.cartGoodsCount=0},addToCart:function(s){if(e=this.userLoginInfo("../goods/goods_detail?goods_id="+c.goods_id,1),e)if(a=t.getStorageSync("cartGoods"),!1===this.openAttr)this.openAttr=!this.openAttr;else{if(!this.selectGoodsAttr.id)return t.showToast({title:"请选择商品规格",icon:"none"}),!1;var i=this.selectGoodsAttr;if(i.num<=0)return t.showToast({title:"库存型号不足",icon:"none"}),!1;var o={goods_id:this.goods.id,goods_name:this.goods.name,attr:i.attrs,image:i.image,price:Number(i.price),market_price:this.goods.market_price,num:this.numberValue},n=this._addToCart(o);0===n.code?(t.showToast({title:"添加成功",icon:"none"}),this.openAttr=!this.openAttr,this.cartGoodsCount=n.goodsCount,"buy"==s&&t.switchTab({url:"../cart/cart"})):t.showToast({title:n.msg,icon:"none"})}},_addToCart:function(t){var s={code:0,msg:"添加成功",goodsCount:0};if(this.getCart(),0==this.cart.length)this.cart.push(t);else{var i=!1;this.cart.forEach(function(s){s.goods_id==t.goods_id&&s.attr==t.attr&&(s.num=s.num+t.num,i=!0)}),0==i&&this.cart.push(t)}return this.setCartGoods(),s.goodsCount=this.cart.length,s},setCartGoods:function(){var s=this,i={uid:e.id,goods:this.cart};if(0==a.length)a=[],a.push(i);else{var o=!1;a.forEach(function(t){t.uid==e.id&&(t.goods=s.cart,o=!0)}),0==o&&a.push(i)}t.setStorageSync("cartGoods",a)},switchAttrPop:function(){!1===this.openAttr&&(this.openAttr=!this.openAttr)},closeAttr:function(){this.openAttr=!1},onNumberChange:function(t){this.numberValue=t},intiAttrs:function(){var t=this;for(var s in t.goods.attrs)t.shopItemInfo[t.goods.attrs[s].attrs]=t.goods.attrs[s];this.initSeleted(),t.checkItem()},initSeleted:function(){var t=this,s=this.goodsAttrId,i=t.goods.attrs_list;for(var e in t.goods.attrs)if(t.goods.attrs[e].id==s){var a=t.goods.attrs[e].attrs.split(",");this.selectArr=a}var o=[];for(var n in t.selectArr)for(var c in i)for(var r in i[c].item)i[c].item[r].name==t.selectArr[n]&&o.push(r);this.subIndex=o},specificationBtn:function(t,s,i,e){var a=this,o=a.goods.attrs;a.goods.attrs_list;this.selectGoodsAttr={};for(var n in a.selectArr[s]!=t?(a.selectArr[s]=t,a.subIndex[s]=e):(a.selectArr[s]="",a.subIndex[s]=-1),o)o[n].attrs==this.selectArr.join(",")&&(this.selectGoodsAttr=o[n]);this.selectGoodsAttr.price&&(this.goods.price=this.selectGoodsAttr.price,this.goods.image=this.selectGoodsAttr.image),a.checkItem()},checkItem:function(){var t=this,s=t.goods.attrs_list,i=[];for(var e in s)i[e]=t.selectArr[e]?t.selectArr[e]:"";for(var a in s){var o=i[a];for(var n in s[a].item)i[a]=s[a].item[n].name,s[a].item[n].isShow=t.isMay(i);i[a]=o}t.$forceUpdate()},isMay:function(t){for(var s in t)if(""==t[s])return!0;return 0!=this.shopItemInfo[t].num},goCart:function(){t.switchTab({url:"../cart/cart"})}}};s.default=d}).call(this,i("6e42")["default"])},edc6:function(t,s,i){"use strict";var e=function(){var t=this,s=t.$createElement,i=t._self._c||s;return i("view",[i("view",{staticClass:"container"},[i("swiper",{staticClass:"goodsimgs",attrs:{"indicator-dots":"true",autoplay:"true",interval:"3000",duration:"500"}},t._l(t.goodsImages,function(s,e){return i("swiper-item",{key:s.id,attrs:{"data-index":e,mpcomid:"012c9b26-0-"+e}},[i("img",{attrs:{src:s.image,"data-src":s.image,eventid:"012c9b26-0-"+e},on:{tap:t.previewImage}})])})),i("view",{staticClass:"goods-info"},[i("view",{staticClass:"c"},[i("view",{staticClass:"name"},[t._v(t._s(t.goods.name))]),i("view",{staticClass:"price"},[t._v("￥"+t._s(t.goods.price))]),t.goods.market_price-t.goods.price!=0||t.flase?i("view",{staticClass:"omit"},[i("text",{staticStyle:{"text-align":"left"}},[t._v("价格立省"+t._s(t.goods.market_price-t.goods.price)+"元")])]):t._e()])]),i("view",{staticClass:"section-nav section-attr",attrs:{eventid:"012c9b26-1"},on:{click:t.switchAttrPop}},[i("view",{staticClass:"t"},[t._v("请选择规格数量")]),i("img",{staticClass:"i",attrs:{src:"http://static.lamamuying.com/static/images/address_right.png","background-size":"cover"}})]),t.goodsComment.count>0?i("view",{staticClass:"comments"},[i("view",{staticClass:"h"},[i("navigator",{attrs:{url:"../comment/comment?valueId="+t.goods.id+"&typeId=0"}},[i("text",{staticClass:"t"},[t._v("评价("+t._s(t.goodsComment.count>999?"999+":t.goodsComment.count)+")")]),i("text",{staticClass:"i"},[t._v("查看全部")])])],1),i("view",{staticClass:"b"},t._l(t.goodsComment.data,function(s,e){return i("view",{key:s.id,staticClass:"item",attrs:{"data-index":e}},[i("view",{staticClass:"info"},[i("view",{staticClass:"user"},[i("img",{attrs:{src:s.avatar}}),i("text",[t._v(t._s(s.nickname))])]),i("view",{staticClass:"time"},[t._v(t._s(s.addtime))])]),i("view",{staticClass:"content"},[t._v(t._s(s.content))])])}))]):t._e(),i("view",{staticClass:"goods-content",staticStyle:{"padding-bottom":"100rpx"}},[i("view",{staticClass:"t"},[t._v("商品详情")]),i("view",{staticClass:"ricetext"},[i("rich-text",{staticStyle:{"font-size":"0"},attrs:{nodes:t.goods.content,mpcomid:"012c9b26-1"}})],1)]),i("my-drawer",{attrs:{visible:t.openAttr,mode:"right",eventid:"012c9b26-9",mpcomid:"012c9b26-3"},on:{close:t.closeAttr}},[i("view",{staticClass:"attr-pop-box"},[i("view",{staticClass:"attr-pop"},[i("view",{staticClass:"close",attrs:{eventid:"012c9b26-2"},on:{click:t.closeAttr}},[i("img",{staticClass:"icon",attrs:{src:"http://static.lamamuying.com/static/images/icon_close.png"}})]),i("view",{staticClass:"img-info"},[i("img",{staticClass:"img",attrs:{src:t.goods.image}}),i("view",{staticClass:"info"},[i("view",{staticClass:"c"},[i("view",{staticClass:"p"},[t._v("价格：￥"+t._s(t.goods.price))]),i("view",{staticClass:"a"},[t._v("已选择："+t._s(t.selectGoodsAttr.attrs))]),i("view",{staticClass:"a"},[t._v("购买数量："+t._s(t.numberValue))])])])]),i("view",{staticClass:"spec-con"},[i("view",{staticClass:"productBox"},[i("view",{staticClass:"productConten"},t._l(t.goods.attrs_list,function(s,e){return i("view",{key:e,staticClass:"product-delcom"},[i("text",[t._v(t._s(s.name))]),i("view",{staticClass:"product-footerlist clearfix"},t._l(s.item,function(s,a){return i("view",{key:a,staticClass:"product-attrs",class:[s.isShow?"":"noneActive",t.subIndex[e]==a?"productActive":""],attrs:{eventid:"012c9b26-3-"+e+"-"+a},on:{click:function(i){t.specificationBtn(s.name,e,i,a)}}},[t._v(t._s(s.name))])}))])}))]),i("view",{staticClass:"number-item"},[i("view",{staticClass:"name"},[t._v("数量")]),i("view",{staticClass:"number"},[i("uni-number-box",{attrs:{min:1,max:99,value:t.numberValue,eventid:"012c9b26-4",mpcomid:"012c9b26-2"},on:{change:t.onNumberChange}})],1)])])])]),i("view",{staticClass:"bottom-btn"},[i("view",{staticClass:"l l-collect",attrs:{eventid:"012c9b26-5"},on:{click:function(s){t.heart()}}},[0===t.icon1?i("span",{staticClass:"iconfont article_icon1",staticStyle:{"font-size":"50rpx",color:"#919191"}},[t._v("")]):t._e(),i("span",{directives:[{name:"show",rawName:"v-show",value:1===t.icon1,expression:"icon1===1"}],staticClass:"iconfont article_icon1",staticStyle:{"font-size":"50rpx",color:"#F9EC51"}},[t._v("")])]),i("view",{staticClass:"l l-cart",attrs:{eventid:"012c9b26-6"},on:{click:t.goCart}},[i("view",{staticClass:"box"},[i("text",{staticClass:"cart-count"},[t._v(t._s(t.cartGoodsCount))]),i("img",{staticClass:"icon",attrs:{src:"http://static.lamamuying.com/static/images/ic_menu_shoping_nor.png"}})])]),i("view",{staticClass:"c",attrs:{eventid:"012c9b26-7"},on:{click:t.addToCart}},[t._v("加入购物车")]),i("view",{staticClass:"r",attrs:{eventid:"012c9b26-8"},on:{click:function(s){t.addToCart("buy")}}},[t._v("立即购买")])])]),i("view",{staticClass:"bottom-btn"},[i("view",{staticClass:"l l-collect",attrs:{eventid:"012c9b26-10"},on:{click:function(s){t.heart()}}},[0===t.icon1?i("span",{staticClass:"iconfont ",staticStyle:{"font-size":"50rpx",color:"#919191"}},[t._v("")]):t._e(),i("span",{directives:[{name:"show",rawName:"v-show",value:1===t.icon1,expression:"icon1===1"}],staticClass:"iconfont ",staticStyle:{"font-size":"50rpx",color:"#F9EC51"}},[t._v("")])]),i("view",{staticClass:"l l-cart",attrs:{eventid:"012c9b26-11"},on:{click:t.goCart}},[i("view",{staticClass:"box"},[i("text",{staticClass:"cart-count"},[t._v(t._s(t.cartGoodsCount))]),i("img",{staticClass:"icon",attrs:{src:"http://static.lamamuying.com/static/images/ic_menu_shoping_nor.png"}})])]),i("view",{staticClass:"c",attrs:{eventid:"012c9b26-12"},on:{click:t.addToCart}},[t._v("加入购物车")]),i("view",{staticClass:"r",attrs:{eventid:"012c9b26-13"},on:{click:function(s){t.addToCart("buy")}}},[t._v("立即购买")])])],1)])},a=[];i.d(s,"a",function(){return e}),i.d(s,"b",function(){return a})},f6bf:function(t,s,i){},f99a:function(t,s,i){"use strict";var e=i("f6bf"),a=i.n(e);a.a}},[["b030","common/runtime","common/vendor"]]]);